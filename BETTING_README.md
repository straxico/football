# 🎯 سیستم پیش‌بینی و قرعه کشی فوتبال

سیستم جامع مدیریت مسابقات فوتبال با قابلیت پیش‌بینی نتایج و لیدربورد

## ✨ ویژگی‌های جدید

### 🔐 سیستم احراز هویت
- ثبت‌نام و ورود کاربران با Supabase
- مدیریت پروفایل کاربری
- نمایش امتیاز در هدر

### 🎯 سیستم پیش‌بینی (Betting)
- انتخاب نتیجه بازی‌ها (برد تیم 1، مساوی، برد تیم 2)
- ثبت و ویرایش پیش‌بینی قبل از شروع بازی
- نمایش صحت پیش‌بینی پس از اتمام بازی
- محاسبه خودکار امتیازات:
  - پیش‌بینی درست: **+3 امتیاز** ✅
  - پیش‌بینی اشتباه: **-1 امتیاز** ❌

### 🏆 لیدربورد
- نمایش 5 پیش‌بینی‌کننده برتر 🥇
- نمایش 5 پیش‌بینی‌کننده‌ای که نیاز به بهبود دارند 😅
- آمار کامل: تعداد پیش‌بینی‌ها، درست، اشتباه، درصد موفقیت
- بروزرسانی خودکار هر 30 ثانیه

### ⚽ امکانات قبلی (بهبود یافته)
- قرعه کشی و گروه‌بندی
- جدول بازی‌ها و نتایج
- جدول رده‌بندی تیم‌ها
- طراحی مدرن و responsive

## 🚀 راه‌اندازی

### 1. نصب وابستگی‌ها
```bash
npm install
```

### 2. راه‌اندازی Supabase

#### الف) ایجاد پروژه در Supabase
1. به [supabase.com](https://supabase.com) بروید
2. یک پروژه جدید ایجاد کنید
3. از بخش Settings > API، مقادیر زیر را کپی کنید:
   - `Project URL`
   - `anon/public key`

#### ب) اجرای اسکریپت دیتابیس
1. به پنل Supabase بروید
2. از منوی سمت چپ، **SQL Editor** را انتخاب کنید
3. محتویات فایل `supabase-setup.sql` را کپی و اجرا کنید
4. تمام جداول و توابع مورد نیاز ایجاد می‌شوند ✅

#### ج) تنظیم متغیرهای محیطی
1. فایل `.env` ایجاد کنید:
```bash
cp .env.example .env
```

2. مقادیر را پر کنید:
```env
VITE_SUPABASE_URL=your_supabase_project_url
VITE_SUPABASE_ANON_KEY=your_supabase_anon_key
```

### 3. اجرای پروژه
```bash
npm run dev
```

پروژه در آدرس `http://localhost:3000` اجرا می‌شود.

## 📊 ساختار دیتابیس

### جدول `betting_users`
- `id`: شناسه کاربر (UUID)
- `email`: ایمیل
- `display_name`: نام نمایشی
- `total_bets`: تعداد کل پیش‌بینی‌ها
- `correct_predictions`: تعداد پیش‌بینی‌های درست
- `wrong_predictions`: تعداد پیش‌بینی‌های اشتباه
- `score`: امتیاز کل

### جدول `bets`
- `id`: شناسه شرط
- `user_id`: شناسه کاربر
- `match_day`: شماره روز بازی
- `match_index`: شماره بازی در روز
- `team1_index`, `team2_index`: شماره تیم‌ها
- `predicted_winner`: تیم برنده پیش‌بینی شده (null برای مساوی)
- `actual_winner`: تیم برنده واقعی
- `is_correct`: صحت پیش‌بینی

## 🎮 نحوه استفاده

### برای کاربران عادی:
1. **ثبت‌نام / ورود**: از صفحه اول ثبت‌نام کنید
2. **مشاهده بازی‌ها**: تب "لیگ و نتایج" را ببینید
3. **پیش‌بینی**: به تب "پیش‌بینی" بروید و نتایج را انتخاب کنید
4. **لیدربورد**: رتبه خود را در تب "لیدربورد" ببینید

### برای ادمین:
1. در تب "لیگ و نتایج"، پنل مدیریت را باز کنید
2. کلید API مدیر JSONBin را وارد کنید
3. قرعه کشی انجام دهید
4. نتایج بازی‌ها را وارد کنید
5. امتیازات به صورت خودکار محاسبه می‌شوند

## 🔧 تنظیمات پیشرفته

### غیرفعال کردن تأیید ایمیل (توسعه)
در پنل Supabase:
1. Authentication > Providers > Email
2. "Confirm email" را غیرفعال کنید

### محدودیت نرخ (Rate Limiting)
می‌توانید در Supabase Dashboard محدودیت تعداد درخواست‌ها را تنظیم کنید.

## 📱 تکنولوژی‌های استفاده شده

- **React 19** + **TypeScript**
- **Supabase** (Authentication + Database)
- **Tailwind CSS** (طراحی)
- **Vite** (Build Tool)
- **JSONBin.io** (ذخیره‌سازی داده‌های لیگ)

## 🎨 ویژگی‌های طراحی

- طراحی Glassmorphism مدرن
- انیمیشن‌های smooth
- Responsive برای موبایل
- Dark mode
- فونت فارسی Vazirmatn
- Gradient های زیبا

## 🔒 امنیت

- Row Level Security (RLS) فعال
- کاربران فقط می‌توانند پیش‌بینی‌های خود را ببینند و ویرایش کنند
- احراز هویت با Supabase Auth
- API Keys در متغیرهای محیطی

## 📝 نکات مهم

1. **قبل از شروع بازی**: کاربران می‌توانند پیش‌بینی کنند یا تغییر دهند
2. **بعد از وارد کردن نتیجه**: دیگر نمی‌توان پیش‌بینی را تغییر داد
3. **امتیازدهی**: به صورت خودکار با Trigger در دیتابیس انجام می‌شود
4. **لیدربورد**: هر 30 ثانیه بروزرسانی می‌شود

## 🐛 عیب‌یابی

### خطای اتصال به Supabase
- مقادیر `.env` را بررسی کنید
- مطمئن شوید اسکریپت SQL اجرا شده است

### پیش‌بینی ثبت نمی‌شود
- وضعیت لاگین را بررسی کنید
- Console مرورگر را برای خطاها چک کنید

### امتیازات بروزرسانی نمی‌شوند
- مطمئن شوید Trigger در دیتابیس ایجاد شده است
- نتیجه بازی را صحیح وارد کرده‌اید

## 🤝 مشارکت

برای گزارش باگ یا پیشنهاد ویژگی جدید، Issue ایجاد کنید.

## 📄 لایسنس

MIT

---

**ساخته شده با ❤️ برای علاقه‌مندان فوتبال**
